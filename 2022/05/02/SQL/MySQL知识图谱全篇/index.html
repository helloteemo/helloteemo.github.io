<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="https://img.helloteemo.com.cn/favicon-32x32-next.ico"><link rel="icon" type="image/png" sizes="16x16" href="https://img.helloteemo.com.cn/favicon-16x16-next.ico"><link rel="mask-icon" href="/images/logo.svg" color="#222"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="google-site-verification" content="cRV2yI-DzG-36rSY_KkaZUfbhwP44Pcb00CdmjipHYU"><meta name="baidu-site-verification" content="code-nKoW4lrjrO"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"helloteemo.github.io",root:"/",scheme:"Pisces",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:"flat"},back2top:{enable:!0,sidebar:!0,scrollpercent:!0},bookmark:{enable:!0,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="MySQL知识全文。"><meta property="og:type" content="article"><meta property="og:title" content="MySQL知识图谱全篇"><meta property="og:url" content="https://helloteemo.github.io/2022/05/02/SQL/MySQL%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1%E5%85%A8%E7%AF%87/index.html"><meta property="og:site_name" content="芒果zzZ"><meta property="og:description" content="MySQL知识全文。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://img.helloteemo.com.cn/2022/05/05/1651727327.png"><meta property="og:image" content="https://img.helloteemo.com.cn/2021.07/image-20210722154757037.png"><meta property="article:published_time" content="2022-05-02T07:13:21.000Z"><meta property="article:modified_time" content="2025-02-10T10:48:17.217Z"><meta property="article:author" content="芒果zzZ"><meta property="article:tag" content="数据库"><meta property="article:tag" content="MySQL"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://img.helloteemo.com.cn/2022/05/05/1651727327.png"><link rel="canonical" href="https://helloteemo.github.io/2022/05/02/SQL/MySQL%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1%E5%85%A8%E7%AF%87/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>MySQL知识图谱全篇 | 芒果zzZ</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css"><link rel="alternate" href="/atom.xml" title="芒果zzZ" type="application/atom+xml">
</head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">芒果zzZ</h1><span class="logo-line-after"><i></i></span></a><p class="site-subtitle" itemprop="description">Java Go</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a></li><li class="menu-item menu-item-schedule"><a href="/schedule/" rel="section"><i class="fa fa-fw fa-calendar"></i>日程表</a></li><li class="menu-item menu-item-todolist"><a href="/todolist/" rel="section"><i class="fa fa-fw fa-clipboard"></i>todolist</a></li><li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="fa fa-fw fa-sitemap"></i>站点地图</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><div class="reading-progress-bar"></div><a role="button" class="book-mark-link book-mark-link-fixed"></a><main class="main"><div class="main-inner"><div class="content-wrap" style="margin-top:2%"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://helloteemo.github.io/2022/05/02/SQL/MySQL%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1%E5%85%A8%E7%AF%87/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="https://img.helloteemo.com.cn/logo.png"><meta itemprop="name" content="芒果zzZ"><meta itemprop="description" content="纵有风花雪月又如何"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="芒果zzZ"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">MySQL知识图谱全篇</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2022-05-02 15:13:21" itemprop="dateCreated datePublished" datetime="2022-05-02T15:13:21+08:00">2022-05-02</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2025-02-10 18:48:17" itemprop="dateModified" datetime="2025-02-10T18:48:17+08:00">2025-02-10</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/SQL/" itemprop="url" rel="index"><span itemprop="name">SQL</span></a> </span></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="post-meta-item-text">阅读次数：</span> <span id="busuanzi_value_page_pv"></span></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>7.9k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>7 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><blockquote><p>MySQL知识全文。</p></blockquote><span id="more"></span><h1 id="mysql知识图谱全篇"><a class="markdownIt-Anchor" href="#mysql知识图谱全篇"></a> MySQL知识图谱全篇</h1><h2 id="目录"><a class="markdownIt-Anchor" href="#目录"></a> 目录</h2><ol><li><a href="#MySQL%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86">MySQL基础知识</a><ol><li><a href="#%E5%9F%BA%E6%9C%AC%E7%BB%93%E6%9E%84">基本结构</a></li><li><a href="#%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E">存储引擎</a></li><li><a href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B">数据类型</a></li><li><a href="#%E7%B4%A2%E5%BC%95">索引</a></li><li><a href="#%E6%97%A5%E5%BF%97%E6%A8%A1%E5%9D%97">日志模块</a></li><li><a href="#%E4%BA%8B%E5%8A%A1">事务</a></li><li><a href="#%E9%94%81">锁</a></li><li><a href="#%E5%9F%BA%E6%9C%ACSQL%E4%BB%A5%E5%8F%8A%E4%BC%98%E5%8C%96">基本SQL以及优化</a></li></ol></li><li><a href="#%E9%9D%A2%E8%AF%95%E9%A2%98">面试题</a></li><li><a href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99">参考资料</a></li></ol><h2 id="span-idmysql基础知识mysql基础知识span"><a class="markdownIt-Anchor" href="#span-idmysql基础知识mysql基础知识span"></a> <span id="MySQL基础知识">MySQL基础知识</span></h2><h3 id="span-id基本结构基本结构span"><a class="markdownIt-Anchor" href="#span-id基本结构基本结构span"></a> <span id="基本结构">基本结构</span></h3><p><code>MySQL</code> 是一个典型的CS结构。我们一般所说的 <code>MySQL</code> 都是它的 Server 结构。Server结构又是什么东西呢？我们应该都在自己的开发机器上安装了 <code>MySQL</code> , 一个比较简单的安装办法就是在MySQL的官网下载包，然后解压之后运行一个 <code>.sh</code> 文件去启动一个 <code>MySQL</code> 进程，这个MySQL进程就是 Server。而 Client 可以是执行 <code>mysql -h localhost -uroot -p</code> 去运行SQL的程序，也可以是自己书写去连接MySQL的代码所运行的程序。</p><p><img src="https://img.helloteemo.com.cn/2022/05/05/1651727327.png" alt="img"></p><blockquote><p>图片取自极客时间 MySQL 实战 45 讲</p></blockquote><p>Server部分又可以更加具体的分为Server层和存储引擎层。MySQL是一个插件式的程序，它可以有不同的存储引擎，但是在处理数据的时候又会有相同的处理过程，因此MySQL把它分为了两个部分，Server层统一处理，存储引擎可以相互替换。</p><p>Server层包括了连接器、查询缓存、分析器、优化器、执行器，涵盖了MySQL的绝大部分核心功能，以及所有的内置函数(日期、时间、数学、加密等)，所有跨存储引擎的功能都在这里实现，比如说存储过程、触发器、视图等。</p><p>储存引擎则负责数据的存储和提取。它是插件式的，可以相互替换，支持InnoDB、MyISAM等。</p><h3 id="span-id存储引擎存储引擎span"><a class="markdownIt-Anchor" href="#span-id存储引擎存储引擎span"></a> <span id="存储引擎">存储引擎</span></h3><p>存储引擎负责数据的存储和提取，MySQL支持多种存储引擎，你甚至可以自行书写一个存储引擎，只要它符合MySQL的协议即可，具体协议已可以在 <a target="_blank" rel="noopener" href="https://github.com/mysql/mysql-server/blob/8d8c986e5716e38cb776b627a8eee9e92241b4ce/sql/handler.h#L3785">GitHub</a> 找到，通过注释也可以看的很清楚，这里就不做过多的说明。</p><p>接下来一下我们常用的几个存储引擎: InnoDB、MyISAM。InnoDB是MySQL5.1版本之后的默认存储引擎，它相对于MyISAM来说最大的特点就是支持事务，以及支持更细粒度的锁。</p><blockquote><p>MySQL存储引擎的设计让我想到设计其余组件的时候，可以把数据操作和数据存储分离开来。这样就可以做到多种数据存储互相替换。这貌似是软件工程的基本思路了，所以的东西都提供接口，架构师设计接口，普通程序猿负责接口的实现，核心程序员负责数据操作部分的实现。哎，什么时候才可以到架构师的水平。。。</p></blockquote><h3 id="span-id数据类型数据类型span"><a class="markdownIt-Anchor" href="#span-id数据类型数据类型span"></a> <span id="数据类型">数据类型</span></h3><p>MySQL的数据类型分为四大类：整型、浮点型、字符串、日期。</p><ul><li>整型</li></ul><p>TINYINT、SMALLINT、MEDIUNINT、INT、BIGINT分别暂用8、16、24、32、64。INT(10) 后面的10表示显示字符的个数，没有实际的意义，但是当与UNSIGNED ZEROFILL配合使用才有实际意义，例如，数据类型INT(3)，属性为UNSIGNED ZEROFILL，如果插入的数据为3的话，实际存储的数据为003</p><table><thead><tr><th>类型</th><th>占用字节</th><th>备注</th></tr></thead><tbody><tr><td>TINYINT</td><td>$\ 2^{3} $</td><td>TINYINT(1)用来表示Boolean</td></tr><tr><td>SMALLINT</td><td>$\ 2^{4} $</td><td></td></tr><tr><td>MEDIUNINT</td><td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">⌈</mo><mfrac><mrow><mo stretchy="false">(</mo><msup><mn>2</mn><mn>4</mn></msup><mo>+</mo><msup><mn>2</mn><mn>5</mn></msup><mo stretchy="false">)</mo></mrow><mn>2</mn></mfrac><mo stretchy="false">⌉</mo></mrow><annotation encoding="application/x-tex">\lceil \frac{(2^{4}+2^{5})}2 \rceil</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4539199999999999em;vertical-align:-.345em"></span><span class="mopen">⌈</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10892em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.485em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8913142857142857em"><span style="top:-2.931em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8913142857142857em"><span style="top:-2.931em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">⌉</span></span></span></span></td><td></td></tr><tr><td>INT</td><td>$\ 2^{5} $</td><td></td></tr><tr><td>BIGINT</td><td>$\ 2^{6} $</td><td></td></tr></tbody></table><ul><li>浮点数</li></ul><p>FLOAT、DOUBLE、DECIMAL。其中DECIMAL使用字符串进行处理，能够精确存储小数，相对于FLOAT、DOUBLE来说效率会低一些，但是在存储账户余额等精度要求特别高的情况下会特别有用。浮点数等都可以指定列宽，比如说DOUBLE(5,3)表示总共可以存储5位，其中小数部分存储3位。</p><ul><li>字符串</li></ul><p>CHAR、VARCHAR、TEXT、BLOB。其中VARCHAR用于存储可变长度的字符串，相比于定长的CHAR更节省空间但也相应的会增加磁盘碎片。TEXT、BLOB都是无限长度的字符串，但是一般避免使用，它们在查询的时候会使用临时表，造成严重的性能开销</p><ul><li>日期</li></ul><p>比较常用的有year、time、date、datetime、timestamp等，datetime保存从1000年到9999年的时间，精度位秒，使用8字节的存储空间，与时区无关。timestamp和UNIX的时间戳相同，保存从1970年1月1日午夜到2038年的时间，精度到秒，使用四个字节的存储空间，并且与时区相关。date只保存年月日。</p><p>应用场景：尽量使用timestamp，相比于datetime它有着更高的空间效率。</p><h3 id="span-id索引索引span"><a class="markdownIt-Anchor" href="#span-id索引索引span"></a> <span id="索引">索引</span></h3><h4 id="索引是什么"><a class="markdownIt-Anchor" href="#索引是什么"></a> 索引是什么</h4><p>索引是数据库中一个排序的数据结构，用于协助<strong>快速查询、更新</strong>数据库表内容。</p><h4 id="为什么需要索引"><a class="markdownIt-Anchor" href="#为什么需要索引"></a> 为什么需要索引</h4><p>当表数据越来越大的时候，需要一种有效的手段来帮助我们快速查找一些内容(更新也需要先查找)。索引就和书籍的目录是一个道理，目录编码了章节和页码，当我们需要找某个特定章节的时候就可以根据目录去找到页码，实现快速定位而不需要一页一页取翻页确定。</p><h4 id="mysql索引名词解释"><a class="markdownIt-Anchor" href="#mysql索引名词解释"></a> MySQL索引名词解释</h4><ol><li>聚簇索引、非聚簇索引。看索引是不是聚簇索引只需要看行数据、索引数据是否是同时存在一个索引的数据结构中即可，在InnoDB中，主键使用的索引就是聚簇索引，而其余索引则是非聚簇索引。比如说一个表<code>create table users(id int primary key,age int, name varchar(25), index(age))</code> 中存在两个索引。第一个默认的就是主键索引，它使用ID进行数据划分，同时在BTree树的叶子结点保存行数据，这个索引就是聚簇索引，还有另外一个索引就是 <code>age</code> 这个非聚簇索引，它的叶子结点不保存数据，而是保存主键的值，这种行数据、索引数据不在一个数据结构中的就认为是非聚簇索引。<strong>在MyISAM中，主键索引和其它索引使用的都是非聚簇索引，叶子结点保存的是地址</strong></li><li>索引种类：主键索引、组合索引、唯一索引、全文索引、普通索引等。</li><li>索引的数据结构：MySQL主要的索引有：<code>FULLTEXT</code> 全文索引、<code>HASH</code> 哈希索引、<code>BTREE</code> B树索引、<code>RTREE</code> 空间数据索引等。</li><li>索引覆盖：索引覆盖实际上就是在查询语句时是否完全使用某一个索引的字段。比如说我们之前的 <code>create table users(id int primary key,age int, name varchar(25), index(age))</code> 表中，如果我们运行 <code>select id,age from users where age = 10;</code> 语句，可以直接使用 <code>age</code> 索引就能够查询出结果，这个时候就认为是索引覆盖，否则查询 <code>select name from users where age = 10</code> 这个时候虽然会使用 <code>age</code> 索引，但是还是需要再次根据ID回表查询主键索引，这样就不能称为索引覆盖。</li><li>回表查询：回表查询在刚刚索引覆盖就已经提到了，也就是说先通过非聚簇索引查询到主键，再通过主键聚簇索引查询到对应数据的过程就称为回表查询。</li><li>索引下推：索引下推就是把索引原本在Server层做的事情交给存储引擎层去做。索引下推可以减少回表次数，可以减少存储引擎上传到Server层的数据。</li></ol><h4 id="索引问题"><a class="markdownIt-Anchor" href="#索引问题"></a> 索引问题</h4><ol><li>索引的数据结构</li></ol><blockquote><p><code>FULLTEXT</code> 索引采用倒排索引，在5.7.6版本及以后，MySQL内置了ngram全文解析器。</p><p><code>HASH</code> 索引采用 <code>HASH</code> 函数作为主要的工具</p><p><code>BTTRE</code> 索引采用B+树作为底层结构，B+数的特点如下：1. 非叶子结点不储存数据 2. 叶子节点以指针形式连接。 B+数的优点如下：</p><p><strong>B+ 树的磁盘读写代价更低</strong></p><p>B+ 树内部非叶子节点本身并不存储数据，所以非叶子节点的存储代价相比 B 树就小的多。存储容量减少同时也缩小了占用盘块的数量，那么数据的聚集程度直接也影响了查询磁盘的次数。</p><p><strong>B+ 树查询效率更加稳定</strong></p><p>树高确定的前提下所有的数据都在叶子节点，那么无论怎么查询所有关键字查询的路径长度是固定的。</p><p><strong>B+ 树对范围查询的支持更好</strong></p><p>B+ 树所有数据都在叶子节点，非叶子节点都是索引，那么做范围查询的时候只需要扫描一遍叶子节点即可；而 B 树因为非叶子节点也保存数据，范围查询的时候要找到具体数据还需要进行一次中序遍历。</p></blockquote><ol start="2"><li>索引下推(ICP)是什么？什么情况下会触发索引下推？</li></ol><blockquote><p><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/index-condition-pushdown-optimization.html">官方文档</a>。<strong>强烈建议大家观看官方文档，目前网络上大部分资料(包括我这里也是翻译)都是官方文档的翻译。</strong></p><p>索引下推是Index Condition Pushdown，全意为索引条件下推，是MySQL针对索引从表中检索行情况下进行的专门优化，也就是 <code>Select</code> 语句匹配到索引进行的优化。如果没有 ICP，存储引擎会遍历索引以定位基表中的行，并将它们返回给 MySQL 服务器，由 MySQL 服务器评估<code>WHERE</code>行的条件。启用 ICP 后，如果部分 <code>WHERE</code>条件可以<strong>仅使用索引中的列</strong>进行评估，则 MySQL 服务器会推送这部分<code>WHERE</code>条件下降到存储引擎。然后，存储引擎通过使用索引条目来评估推送的索引条件，并且只有在满足这一条件时才从表中读取行。ICP可以减少存储引擎必须访问基表的次数和MySQL服务器必须访问存储引擎的次数。</p><p>当查询语句满足以下情况下会触发索引下推：</p><ul><li>ICP用于 range， ref， eq_ref，和 ref_or_null访问方法时，并有必要访问完整的表时。</li><li>ICP可用于InnoDB引擎和MyISAM引擎，包括分区表。</li><li>对于InnoDB引擎，ICP仅用于非聚簇索引。ICP的目标是减少全行读取的数量，从而减少I/O操作。对于 InnoDB聚簇索引，它已有完整的记录。在这种情况下使用ICP不会降低I/O，自然也不会使用索引下推。</li><li>在虚拟生成列上创建的非聚簇索引不支持ICP。InnoDB 支持虚拟生成列上的非聚簇索引。</li><li>引用子查询的条件无法下推。</li><li>引用存储函数的条件无法下推。存储引擎无法调用存储的函数。</li><li>触发条件查询时无法下推。</li></ul></blockquote><h3 id="span-id日志模块日志模块span"><a class="markdownIt-Anchor" href="#span-id日志模块日志模块span"></a> <span id="日志模块">日志模块</span></h3><p>MySQL有三大日志模块： <code>redolog、undolog、binlog</code> 他们各有各的作用，接下来我们就开始从 <code>redolog</code> 说说</p><h4 id="redolog"><a class="markdownIt-Anchor" href="#redolog"></a> <code>redolog</code></h4><p><code>redolog</code> 保存着存储引擎对数据页的操作，是 <code>InnoDB</code> 特有的<strong>文件日志</strong>，被设计为固定大小、顺序写入的类循环队列的日志形式，用于保证MySQL的 <code>crash-safe</code> 能力。</p><p>我们都知道 <code>redolog</code> 被用在 <code>update</code> 等更新语句中，那么如果每次都需要更新数据页这是一个很大的性能开销，因为每一行都被存储引擎随机存储到数据页中。那么存不存在一种方法，能够兼顾性能的同时有保证安全呢？这就是MySQL的WAL技术，也就是 <code>Write-Ahead Logging</code> ，WAL技术的关键在于先写日志，再写磁盘，顺序写入 <code>redolog</code> 日志的开销会比随机写磁盘的I/O性能消耗小很多。</p><p>总体来说，当我们需要更新一条语句的时候，<code>InnoDB</code> 会先把记录(在某个数据页中做了什么改动)顺序写入磁盘中，并更新 <code>BufferPool</code> 的内存数据，这样就认为更新已经完成了。同时 <code>InnoDB</code> 会在某个恰当的时间把 <code>BufferPool</code> 的数据同步到磁盘中去。</p><p><code>redolog</code> 也不是直接刷入磁盘的，它也就自己的缓存区，<code>redolog buffer</code>。</p><blockquote><p>需要注意的是：</p><ol><li><code>redolog</code> 也是日志文件哦，它保存在磁盘中！！！</li><li><code>redolog</code> 是类循环队列的形式，它由N个文件组成一个循环队列，有两个点需要关注： <code>WritePos CheckPoint</code> 。<code>WritePos</code> 代表当前记录写入的位置， <code>CheckPoint</code> 代表上次同步的位置。</li><li>上文所说的把 <code>BufferPool</code> 在某个恰当的时间同步到磁盘中的某个恰当的时间点指的是： 系统较为空闲的时候、<code>redolog</code> 空间不足的时候( <code>WritePos &gt;= CheckPoint</code>)、</li><li>同步一般指的是把 <code>BufferPool</code> 的数据同步到磁盘中，<code>redolog</code> 一般在 <code>crash</code> 使用。</li></ol></blockquote><h4 id="binglog"><a class="markdownIt-Anchor" href="#binglog"></a> <code>binglog</code></h4><p>我们上面说到的 <code>redolog</code> 是 <code>InnoDB</code> 存储引擎的日志，那么在 <code>Server</code> 层有没有属于自己的日志呢？有，我们称为 <code>binlog</code>，它为MySQL提供归档能力。</p><p><code>binlog</code> 与 <code>redolog</code> 有四点不同：</p><ol><li><code>binlog</code> 是 <code>Server</code> 层的日志，<code>redolog</code> 是存储引擎的日志</li><li><code>binlog</code> 记录的是逻辑日志，也就是语句的原始逻辑，比如说给某个表的某个字段进行了修改。<code>redolog</code> 记录的是物理日志，在某个数据页上做了什么改动</li><li><code>binlog</code> 是追加写入的，<code>redolog</code> 是循环写入的</li><li><code>redolog</code> 作为异常宕机或者介质故障后的数据恢复使用；<code>binlog</code> 作为恢复数据使用，主从复制搭建。</li></ol><p><code>binlog</code> 有三种文件记录模式</p><ol><li><code>row</code> 记录每一行被修改的情况，包括原本的数据和之后的数据，一般使用 <code>row</code></li><li><code>statement</code> 记录SQL语句</li><li><code>mixed</code> 混合</li></ol><h4 id="日志的二阶段提交"><a class="markdownIt-Anchor" href="#日志的二阶段提交"></a> <strong>日志的二阶段提交</strong></h4><p>上文提到了 <code>binlog</code> 和 <code>redolog</code> 分别属于两个部分的日志，那么它们是如何保证日志一致性的呢？如果在写完 <code>redolog</code> 准备写 <code>binlog</code> 的时候程序宕机了，那么是不是 <code>redolog</code> 有日志而 <code>binlog</code> 没有日志呢？会不会造成主库与从库的数据不一致呢？哎嘿，当然是不会的，这里就需要讲到日志的二阶段提交。</p><p>我们从一条 <code>update t set n=2 where id = 1;</code> 语句讲起，MySQL的处理流程</p><ol><li>拿到 <code>id=2</code> 的数据，如果 <code>BufferPool</code> 存在就直接拿，如果没有就从磁盘中找到对应的页数据并载入到 <code>BufferPool</code> 中</li><li>在 <code>BufferPool</code> 的 <code>Data Page</code> 做 Update 操作，并把操作的物理数据页修改记录到 <code>redolog buffer</code> 中，并在未来的某个时间点同步到 <code>redolog</code> 中，此时 <code>redolog</code> 处于 <code>Prepare</code> 状态</li><li>写入 <code>binlog</code></li><li>提交事务，把 <code>redolog</code> 设置为 <code>commit</code> 状态</li></ol><p>为什么需要二阶段提交呢？</p><blockquote><p>为了保证 <code>redolog</code> 和 <code>binlog</code> 的一致性。我们提到 <code>redolog</code> 用于异常宕机的数据恢复， <code>binlog</code> 用于主从复制，如果 <code>redolog</code>、<code>binlog</code> 数据不一致，就很可能存在主服务通过 <code>redolog</code> 恢复数据之后与使用 <code>binlog</code> 同步数据的从服务数据不一致</p></blockquote><p>当前有三个阶段 1. <code>prepare</code> 2. 写入 <code>binlog</code> 3. <code>commit</code></p><ul><li>在写入 <code>binlog</code> 时程序宕机了，这时 <code>redolog</code> 有一条处于 <code>prepare</code> 的数据，而 <code>binlog</code> 没有数据。在使用 <code>redolog</code> 恢复数据的时候会发现有一条 <code>prepare</code> 的记录，并且在 <code>binlog</code> 中找不到这一个事务的提交记录。就回滚这条 <code>redolog</code></li><li>在3之前奔溃，这时 <code>redolog</code> 和 <code>binlog</code> 都有数据，但是 <code>redolog</code> 的状态还是 <code>prepare</code> 。在使用 <code>redolog</code> 恢复数据的时候会发现有一条 <code>prepare</code> 的记录，并且在 <code>binlog</code> 中属于已提交的，那么就会修改 <code>redolog</code> 自动提交。</li></ul><h4 id="undolog"><a class="markdownIt-Anchor" href="#undolog"></a> <code>undolog</code></h4><p><code>undolog</code> 则记录了事务 <code>rollback</code> 所需要的信息。</p><p><code>undolog</code> 的回滚有一个很重要的概念叫事务ID(tx_Id)。</p><p><code>undolog</code> 如何存储多个版本的数据</p><blockquote><p><code>Innodb</code> 在每一行中都会有一些隐藏的字段，比如说</p><ol><li><code>DB_ROW_ID</code> 用来生成默认的聚簇索引，如果没有指定主键索引就会使用该字段创建。</li><li><code>DB_TRX_ID</code> 用来表示操作这个数据的事务ID，也就是最后一次对该数据进行修改的事务ID。</li><li><code>DB_ROLL_PTR</code> 回滚指针，指向这个记录的 <code>undolog</code> 日志</li></ol><p>而 <code>undolog</code> 中也保存了这些行的信息。也就是说 <code>undolog</code> 通过回滚指针把数据行版本串联起来了，其中数据行就是链表的头节点，而每次有事务进行操作就相对于往 <code>undolog</code> 中插入头节点，并重新生成一个头节点给数据行。</p></blockquote><p>为什么需要 <code>undolog</code></p><blockquote><p>因为在事务还未提交时，可能 <code>redolog</code> 已经刷盘了，这个时候MySQL宕机了，这个时候依靠 <code>redolog</code> 恢复的我们发现这条日志还没有提交，我们就需要会滚这条日志，但是我们又不清楚 <code>redolog</code> 这个页面之前的记录是什么，这个时候就需要 <code>undolog</code> 来发挥作用</p></blockquote><h3 id="span-id事务事务span"><a class="markdownIt-Anchor" href="#span-id事务事务span"></a> <span id="事务">事务</span></h3><h4 id="什么是事务"><a class="markdownIt-Anchor" href="#什么是事务"></a> 什么是事务</h4><p>事务就是保证一组数据库操作要不全部成功要不全部失败。</p><h4 id="事务四大特性"><a class="markdownIt-Anchor" href="#事务四大特性"></a> 事务四大特性</h4><p>原子性：事务操作要不全部成功要不完全失败。由 <code>undolog</code> 实现</p><p>一致性：一个事务的开始到结束都需要保证数据的完整性不被破坏。由 程序 + <code>AID</code> 实现</p><p>隔离性：数据库允许多个事务并发执行。由 <code>undolog</code> 和 <code>MVCC</code> 实现</p><p>持久性：数据事务一旦处理完成，对数据的修改便是永久的。由 <code>redolog</code> 实现</p><h4 id="事务问题"><a class="markdownIt-Anchor" href="#事务问题"></a> 事务问题</h4><p>当有多个事务并发执行的时候，就会出现特定的问题，比如说</p><ol><li>脏读：事务A读到了事务B未提交的数据</li><li>幻读：事务A两次查询查询了某些行，其中第二次查找到了事务B已插入或者删除的行</li><li>可重复读：事务A两次查询了某些行，其中第二次查找到了事务B已修改的行数据</li></ol><h4 id="事务隔离级别"><a class="markdownIt-Anchor" href="#事务隔离级别"></a> 事务隔离级别</h4><p>为了解决事务问题我们提出了事务隔离级别概念，目前有四个事务隔离级别，其中隔离级别依次提高</p><ol><li>读未提交：事务A可以读到其余事务未提交的数据</li><li>读已提交：事务A可以读到其余事务已提交的数据，不能读到未提交的数据</li><li>可重复读：事务A在执行过程中看到的数据，就是事务开始时的数据</li><li>串行化：对同一行记录加读写锁，后一个访问的事务需要等待上一个事务提交</li></ol><h4 id="mvcc原理"><a class="markdownIt-Anchor" href="#mvcc原理"></a> MVCC原理</h4><p>MVCC是多版本并发控制器，是在并发访问数据库时，通过对数据进行版本控制从而解决锁问题</p><p>MVCC的两个核心点是 <code>undolog</code> 和 <code>ReadView</code> 读视图，其中 <code>undolog</code> 用来保护版本数据，<code>ReadView</code> 用来保存当前活跃的事务列表。</p><p><code>undolog</code> 我们在上文已经讲解过了，现在我们重点分析一下读视图。</p><p><code>ReadView</code> 就是事务进行快照度的时候生产出来的，在事务执行快照读的时候，会生成数据库系统的当前的快照，记录并维护系统当前活跃的事务ID。</p><p><code>ReadView</code> 有三个重要属性：</p><ol><li><code>trx_list</code> 未提交事务的ID列表</li><li><code>up_limit_id</code> 记录 <code>trx_list</code> 列表中的最小事务ID</li><li><code>low_limit_id</code> 当前出现的最大事务ID+1</li></ol><p><img src="https://img.helloteemo.com.cn/2021.07/image-20210722154757037.png" alt="image-20210722154757037"></p><p><code>ReadView</code> 遵循一个可见性算法，主要是将要被修改的数据的最新记录中的 <code>DB_TRX_ID</code> （即当前事务ID）取出来，与系统当前其他活跃事务的ID去对比（由 <code>ReadView</code> 维护），如果 <code>DB_TRX_ID</code> 跟 <code>ReadView</code> 的属性做了某些比较，不符合可见性，那就通过 <code>DB_ROLL_PTR</code> 回滚指针去取出 <code>undoog</code> 中的 <code>DB_TRX_ID</code> 再比较，即遍历链表的 <code>DB_TRX_ID</code>（从链首到链尾，即从最近的一次修改查起），直到找到满足特定条件的 <code>DB_TRX_ID</code>, 那么这个 <code>DB_TRX_ID</code> 所在的旧记录就是当前事务能看见的最新老版本。</p><p>因为 <code>low_limit_id</code> 和 <code>trx_ids</code> 要不就是 <code>ReadView</code> 创建之后的事务，要不就是当前未提交的事务ID集合。所以这两个都是不可见的。</p><p><code>Read Commited</code> 和 <code>Reaptable Read</code> 的区别就在于你每次进行读操作的时候是否重新生成一个 <code>ReadView</code> 。如果重新生成 <code>ReadView</code> 的话，就代表每次读取的时候都会获得已提交的事务修改的内容，即 <code>up_limit_id</code> 会更新为最新的 <code>trx_id</code> ,也就是说是 <code>Read Commited</code> 隔离级别。</p><h3 id="span-id锁锁span"><a class="markdownIt-Anchor" href="#span-id锁锁span"></a> <span id="锁">锁</span></h3><h3 id="span-id基本sql以及优化基本sql以及优化span"><a class="markdownIt-Anchor" href="#span-id基本sql以及优化基本sql以及优化span"></a> <span id="基本SQL以及优化">基本SQL以及优化</span></h3><h2 id="span-id面试题面试题span"><a class="markdownIt-Anchor" href="#span-id面试题面试题span"></a> <span id="面试题">面试题</span></h2><h3 id="索引面试题"><a class="markdownIt-Anchor" href="#索引面试题"></a> 索引面试题</h3><ul><li>索引数据结构</li></ul><blockquote><p>一般来说就是 BTree\Hash\FullText\RTree</p><p>其中BTree是B+树</p><p>Hash适用Hash表</p><p>FullText使用倒排索引</p><p>RTree使用空间数据索引</p></blockquote><ul><li>聚簇索引和非聚簇索引</li></ul><blockquote><p>聚簇索引包含数据，非聚簇索引不饱和数据</p></blockquote><ul><li>为什么适用B+树而不是B树</li></ul><blockquote><ol><li>为了获取更加稳定的性能</li><li>B+树更适合范围查找</li><li>B+树可以减少磁盘I/O</li></ol></blockquote><ul><li>非聚簇索引一定会回表吗</li></ul><blockquote><p>不一定，要看索引覆盖</p></blockquote><ul><li>索引下推是什么？</li></ul><blockquote><p>把原本在Server层做的事情下放到存储引擎去做</p></blockquote><h3 id="日志面试题"><a class="markdownIt-Anchor" href="#日志面试题"></a> 日志面试题</h3><h2 id="span-id基本资料参考资料span"><a class="markdownIt-Anchor" href="#span-id基本资料参考资料span"></a> <span id="基本资料">参考资料</span></h2><ol><li><a target="_blank" rel="noopener" href="https://time.geekbang.org/column/article/68319">MySQL实战45讲</a> 本人特别推荐大家购买学习</li><li><a target="_blank" rel="noopener" href="https://juejin.cn/post/6955667738006126600#heading-0">简书- MySQL核心知识</a></li><li><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000039869289">索引下堆</a></li><li><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/index-condition-pushdown-optimization.html">索引下堆官方文档</a></li><li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/rickiyang/p/13559507.html">索引优势等</a></li><li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/kxxiaomutou/p/16023149.html">日志介绍</a></li></ol></div><div class="reward-container"><div>请用钱砸死我！！！</div><button onclick='var qr=document.getElementById("qr");qr.style.display="none"===qr.style.display?"block":"none"'>打赏</button><div id="qr" style="display:none"><div style="display:inline-block"><img src="https://img.helloteemo.com.cn/wechatpay.png" alt="芒果zzZ 微信支付"><p>微信支付</p></div><div style="display:inline-block"><img src="https://img.helloteemo.com.cn/alipay.png" alt="芒果zzZ 支付宝"><p>支付宝</p></div></div></div><footer class="post-footer"><div class="post-tags"><a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="tag"># 数据库</a> <a href="/tags/MySQL/" rel="tag"># MySQL</a></div><div class="post-nav"><div class="post-nav-item"><a href="/2022/02/13/Golang/%E9%80%9A%E8%BF%87%E5%87%BD%E6%95%B0%E4%BC%A0%E9%80%92%E8%A7%A3%E5%86%B3Go%E5%BE%AA%E7%8E%AF%E5%BC%95%E7%94%A8/" rel="prev" title="通过函数传递解决Go循环引用"><i class="fa fa-chevron-left"></i> 通过函数传递解决Go循环引用</a></div><div class="post-nav-item"><a href="/2022/06/13/Golang/Logrus%E6%89%93%E5%8D%B0trace/" rel="next" title="Logrus打印trace">Logrus打印trace <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="gitalk-container"></div><script>window.addEventListener("tabs:register",()=>{let{activeClass:t}=CONFIG.comments;if(CONFIG.comments.storage&&(t=localStorage.getItem("comments_active")||t),t){let e=document.querySelector(`a[href="#comment-${t}"]`);e&&e.click()}}),CONFIG.comments.storage&&window.addEventListener("tabs:click",t=>{if(!t.target.matches(".tabs-comment .tab-content .tab-pane"))return;let e=t.target.classList[1];localStorage.setItem("comments_active",e)})</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#mysql%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1%E5%85%A8%E7%AF%87"><span class="nav-number">1.</span> <span class="nav-text">MySQL知识图谱全篇</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%9B%AE%E5%BD%95"><span class="nav-number">1.1.</span> <span class="nav-text">目录</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#span-idmysql%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86mysql%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86span"><span class="nav-number">1.2.</span> <span class="nav-text">MySQL基础知识</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#span-id%E5%9F%BA%E6%9C%AC%E7%BB%93%E6%9E%84%E5%9F%BA%E6%9C%AC%E7%BB%93%E6%9E%84span"><span class="nav-number">1.2.1.</span> <span class="nav-text">基本结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#span-id%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8Espan"><span class="nav-number">1.2.2.</span> <span class="nav-text">存储引擎</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#span-id%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8Bspan"><span class="nav-number">1.2.3.</span> <span class="nav-text">数据类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#span-id%E7%B4%A2%E5%BC%95%E7%B4%A2%E5%BC%95span"><span class="nav-number">1.2.4.</span> <span class="nav-text">索引</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B4%A2%E5%BC%95%E6%98%AF%E4%BB%80%E4%B9%88"><span class="nav-number">1.2.4.1.</span> <span class="nav-text">索引是什么</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E7%B4%A2%E5%BC%95"><span class="nav-number">1.2.4.2.</span> <span class="nav-text">为什么需要索引</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#mysql%E7%B4%A2%E5%BC%95%E5%90%8D%E8%AF%8D%E8%A7%A3%E9%87%8A"><span class="nav-number">1.2.4.3.</span> <span class="nav-text">MySQL索引名词解释</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B4%A2%E5%BC%95%E9%97%AE%E9%A2%98"><span class="nav-number">1.2.4.4.</span> <span class="nav-text">索引问题</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#span-id%E6%97%A5%E5%BF%97%E6%A8%A1%E5%9D%97%E6%97%A5%E5%BF%97%E6%A8%A1%E5%9D%97span"><span class="nav-number">1.2.5.</span> <span class="nav-text">日志模块</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#redolog"><span class="nav-number">1.2.5.1.</span> <span class="nav-text">redolog</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#binglog"><span class="nav-number">1.2.5.2.</span> <span class="nav-text">binglog</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%97%A5%E5%BF%97%E7%9A%84%E4%BA%8C%E9%98%B6%E6%AE%B5%E6%8F%90%E4%BA%A4"><span class="nav-number">1.2.5.3.</span> <span class="nav-text">日志的二阶段提交</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#undolog"><span class="nav-number">1.2.5.4.</span> <span class="nav-text">undolog</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#span-id%E4%BA%8B%E5%8A%A1%E4%BA%8B%E5%8A%A1span"><span class="nav-number">1.2.6.</span> <span class="nav-text">事务</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E4%BA%8B%E5%8A%A1"><span class="nav-number">1.2.6.1.</span> <span class="nav-text">什么是事务</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%8B%E5%8A%A1%E5%9B%9B%E5%A4%A7%E7%89%B9%E6%80%A7"><span class="nav-number">1.2.6.2.</span> <span class="nav-text">事务四大特性</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%8B%E5%8A%A1%E9%97%AE%E9%A2%98"><span class="nav-number">1.2.6.3.</span> <span class="nav-text">事务问题</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB"><span class="nav-number">1.2.6.4.</span> <span class="nav-text">事务隔离级别</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#mvcc%E5%8E%9F%E7%90%86"><span class="nav-number">1.2.6.5.</span> <span class="nav-text">MVCC原理</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#span-id%E9%94%81%E9%94%81span"><span class="nav-number">1.2.7.</span> <span class="nav-text">锁</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#span-id%E5%9F%BA%E6%9C%ACsql%E4%BB%A5%E5%8F%8A%E4%BC%98%E5%8C%96%E5%9F%BA%E6%9C%ACsql%E4%BB%A5%E5%8F%8A%E4%BC%98%E5%8C%96span"><span class="nav-number">1.2.8.</span> <span class="nav-text">基本SQL以及优化</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#span-id%E9%9D%A2%E8%AF%95%E9%A2%98%E9%9D%A2%E8%AF%95%E9%A2%98span"><span class="nav-number">1.3.</span> <span class="nav-text">面试题</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%B4%A2%E5%BC%95%E9%9D%A2%E8%AF%95%E9%A2%98"><span class="nav-number">1.3.1.</span> <span class="nav-text">索引面试题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%97%A5%E5%BF%97%E9%9D%A2%E8%AF%95%E9%A2%98"><span class="nav-number">1.3.2.</span> <span class="nav-text">日志面试题</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#span-id%E5%9F%BA%E6%9C%AC%E8%B5%84%E6%96%99%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99span"><span class="nav-number">1.4.</span> <span class="nav-text">参考资料</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="芒果zzZ" src="https://img.helloteemo.com.cn/logo.png"><p class="site-author-name" itemprop="name">芒果zzZ</p><div class="site-description" itemprop="description">纵有风花雪月又如何</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">62</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">23</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">22</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/helloteemo" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;helloteemo" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a> </span><span class="links-of-author-item"><a href="mailto:zhukewei1998@gmail.com" title="E-Mail → mailto:zhukewei1998@gmail.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a></span></div><div class="links-of-blogroll motion-element"><div class="links-of-blogroll-title"><i class="fa fa-fw fa-link"></i> Links</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"><a href="https://www.gkshi.com/" title="https:&#x2F;&#x2F;www.gkshi.com&#x2F;" rel="noopener" target="_blank">gkshi的小站</a></li><li class="links-of-blogroll-item"><a href="https://zhouxuwen.github.io/" title="https:&#x2F;&#x2F;zhouxuwen.github.io&#x2F;" rel="noopener" target="_blank">zxw的小破站</a></li><li class="links-of-blogroll-item"><a href="https://sicuni.github.io/" title="https:&#x2F;&#x2F;sicuni.github.io&#x2F;" rel="noopener" target="_blank">sicuni的站点</a></li></ul></div></div><div class="back-to-top motion-element"><i class="fa fa-arrow-up"></i> <span>0%</span></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="beian"><a href="http://www.beian.miit.gov.cn/" rel="noopener" target="_blank">赣ICP备20008539号</a></div><div class="copyright">&copy; 2020 – <span itemprop="copyrightYear">2025</span> <span class="with-love"><i class="fa fa-user"></i> </span><span class="author" itemprop="copyrightHolder">芒果zzZ</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-area-chart"></i> </span><span title="站点总字数">137k</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span title="站点阅读时长">2:05</span></div><br><span id="timeDate">载入天数...</span> <span id="times">载入时分秒...</span><script>var now=new Date;function createtime(){var n=new Date("09/21/2020 15:54:40");now.setTime(now.getTime()+250),days=(now-n)/1e3/60/60/24,dnum=Math.floor(days),hours=(now-n)/1e3/60/60-24*dnum,hnum=Math.floor(hours),1==String(hnum).length&&(hnum="0"+hnum),minutes=(now-n)/1e3/60-1440*dnum-60*hnum,mnum=Math.floor(minutes),1==String(mnum).length&&(mnum="0"+mnum),seconds=(now-n)/1e3-86400*dnum-3600*hnum-60*mnum,snum=Math.round(seconds),1==String(snum).length&&(snum="0"+snum),document.getElementById("timeDate").innerHTML="本站已安全运行 "+dnum+" 天 ",document.getElementById("times").innerHTML=hnum+" 小时 "+mnum+" 分 "+snum+" 秒"}setInterval("createtime()",250)</script><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-user"></i> </span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span> </span></span><span class="post-meta-divider">|</span> <span class="post-meta-item" id="busuanzi_container_site_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div></div></footer></div><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script><script src="/js/local-search.js"></script><script>document.querySelectorAll("pre.mermaid").length&&NexT.utils.getScript("//cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js",()=>{mermaid.initialize({theme:"forest",logLevel:3,flowchart:{curve:"linear"},gantt:{axisFormat:"%m/%d/%Y"},sequence:{actorMargin:50}})},window.mermaid)</script><script>"undefined"==typeof MathJax?(window.MathJax={loader:{source:{"[tex]/amsCd":"[tex]/amscd","[tex]/AMScd":"[tex]/amscd"}},tex:{inlineMath:{"[+]":[["$","$"]]},tags:"ams"},options:{renderActions:{findScript:[10,e=>{document.querySelectorAll('script[type^="math/tex"]').forEach(t=>{const a=!!t.type.match(/; *mode=display/),n=new e.options.MathItem(t.textContent,e.inputJax[0],a),d=document.createTextNode("");t.parentNode.replaceChild(d,t),n.start={node:d,delim:"",n:0},n.end={node:d,delim:"",n:0},e.math.push(n)})},"",!1],insertedScript:[200,()=>{document.querySelectorAll("mjx-container").forEach(e=>{let t=e.parentNode;"li"===t.nodeName.toLowerCase()&&t.parentNode.classList.add("has-jax")})},"",!1]}}},function(){var e=document.createElement("script");e.src="//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js",e.defer=!0,document.head.appendChild(e)}()):(MathJax.startup.document.state(0),MathJax.texReset(),MathJax.typeset())</script><script src="//cdn.jsdelivr.net/npm/quicklink@1/dist/quicklink.umd.js"></script><script>window.addEventListener("load",()=>{quicklink({timeout:3e3,priority:!0,ignores:[i=>i.includes("#"),i=>"https://helloteemo.github.io/2022/05/02/SQL/MySQL%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1%E5%85%A8%E7%AF%87/"===i]})})</script><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css"><script>NexT.utils.loadComments(document.querySelector("#gitalk-container"),()=>{NexT.utils.getScript("//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js",()=>{new Gitalk({clientID:"b0b6e2613d61bb99e835",clientSecret:"50a2d0e2f5dbf4ead8968013003a0557d0076283",repo:"helloteemo.github.io",owner:"helloteemo",admin:["helloteemo"],id:"1c400e084d7a6c7eac89571db72bcccc",language:"zh-CN",distractionFreeMode:!0}).render("gitalk-container")},window.Gitalk)})</script></body></html>